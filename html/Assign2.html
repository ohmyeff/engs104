
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Jenny Qiu Optimization Assignment 2</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-11-02"><meta name="DC.source" content="Assign2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Jenny Qiu Optimization Assignment 2</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Problem 1</a></li><li><a href="#2">Problem 2a - infinity norm</a></li><li><a href="#3">Problem 2b - l1  norm</a></li><li><a href="#4">Problem 2c - l2 norm</a></li><li><a href="#5">Problem 2d - sum norms</a></li><li><a href="#6">Problem 3 maxflow</a></li><li><a href="#7">Problem 4 duality</a></li><li><a href="#8">Problem 5  three sets</a></li></ul></div><h2>Problem 1<a name="1"></a></h2><pre class="codeinput">load (<span class="string">'a2p1'</span>,<span class="string">'-mat'</span>)
n = 35; m =100;
ub = 0.00001*ones(100,1);
ub(23)=9999;
[x fval] = linprog(c,[],[],a,b,zeros(100,1),ub);
display(x(23))
display(fval)


[x2 fval2] = linprog(c,[],[],a,b,zeros(100,1),ub);
display(x2)
display(fval2)
ub2=ub;
ub2(4)=ub2(23);
ub2(12)=ub2(23);
[x3 fval3] = linprog(c,[],[],a,b,zeros(100,1),ub2);
display(x3)
display(fval3)
</pre><pre class="codeoutput">Exiting: One or more of the residuals, duality gap, or total relative error
 has stalled:
         the primal appears to be infeasible (and the dual unbounded).
         (The dual residual &lt; TolFun=1.00e-08.)

ans =

    1.3004


fval =

   94.4520

Exiting: One or more of the residuals, duality gap, or total relative error
 has stalled:
         the primal appears to be infeasible (and the dual unbounded).
         (The dual residual &lt; TolFun=1.00e-08.)

x2 =

    1.1375
    0.6558
    1.1633
    1.1425
    0.9383
    1.1435
    1.1403
    1.1414
    1.1760
    0.5490
    1.2066
    0.2903
    1.1380
    0.7010
    1.0389
    1.1479
    1.1396
    0.6257
    1.0364
    1.1431
    1.1384
    1.1823
    1.3004
    0.4515
    1.1681
    1.1526
    0.6453
    1.0475
    0.3650
    1.1690
    1.2053
    1.1574
    1.2078
    1.1459
    1.1463
    1.1549
    0.9987
    1.1399
    0.5033
    0.9838
    1.1654
    1.0126
    1.1636
    1.1450
    0.7629
    1.0553
    0.7103
    1.1961
    1.1949
    1.2114
    0.7794
    1.1481
    1.1596
    0.1139
    1.2614
    1.1911
    1.1137
    1.1506
    0.7986
    0.4960
    1.1478
    1.1475
    1.1552
    1.0155
    0.2364
    1.1445
    1.1409
    1.1627
    1.1352
    1.1404
    1.1608
    1.1852
    1.1955
    1.1518
    1.1740
    1.1488
    1.1498
    1.1692
    0.8517
    0.9822
    0.0064
    1.1774
    0.3507
    1.1794
    0.2094
    1.0254
    1.1587
    1.1380
    1.1476
    1.1318
    1.1404
    1.1377
    1.1414
    0.2827
    1.1891
    0.7543
    1.1399
    1.1452
    1.1450
    1.1500


fval2 =

   94.4520

Exiting: One or more of the residuals, duality gap, or total relative error
 has stalled:
         the primal appears to be infeasible (and the dual unbounded).
         (The dual residual &lt; TolFun=1.00e-08.)

x3 =

    1.1125
    1.1218
    1.1357
    2.3809
    0.4664
    1.1158
    1.1138
    1.1141
    0.9846
    0.6507
    1.1770
    0.1513
    1.1139
    0.6632
    1.1916
    1.1120
    1.1116
    0.2690
    1.0924
    1.1142
    1.1179
    1.1562
    1.7229
    0.5107
    1.1429
    1.1270
    0.7656
    1.1548
    0.3129
    1.1443
    1.1757
    1.1261
    1.1790
    1.1156
    1.1279
    1.1352
    0.8762
    0.9534
    0.0002
    0.9872
    1.1373
    0.5566
    1.1335
    0.9028
    1.1430
    0.7835
    0.5389
    1.1663
    1.0057
    1.1814
    0.8672
    0.8939
    0.8451
    0.0007
    1.2314
    1.1622
    1.1463
    1.1230
    0.9321
    0.7561
    1.1127
    1.0541
    1.1270
    0.6619
    0.8738
    1.1179
    1.1091
    1.1367
    1.0940
    1.1138
    1.1281
    1.1614
    1.1648
    1.1290
    1.1441
    1.1166
    1.1242
    1.1401
    0.8534
    1.1444
    0.3876
    1.1540
    0.0003
    1.1535
    0.9933
    1.0808
    1.1572
    1.1113
    1.1177
    1.1152
    1.1114
    1.1109
    1.1143
    0.8131
    1.1590
    1.2164
    1.1096
    0.8467
    1.1178
    1.1216


fval3 =

   83.6242

</pre><h2>Problem 2a - infinity norm<a name="2"></a></h2><pre class="codeinput">n = 35; m =100;
aa = a'; bb = c';
Aeq = [aa -ones(m,1);-aa -ones(m,1)];
Beq = [bb;-bb];
A = [aa zeros(m,1)];
B = [b; zeros(m-n,1)];
f = [zeros(1,n), 1];
[xb fvalb]=linprog(f,Aeq,Beq,[],[]);
</pre><pre class="codeoutput">Optimization terminated.
</pre><h2>Problem 2b - l1  norm<a name="3"></a></h2><pre class="codeinput">aa = a'; bb = c';
Aeq = [aa -eye(m, m);-aa -eye(m,m)];
Beq = [bb;-bb];
A = [aa zeros(m)];
B = [b; zeros(m-n,1)];
f = [zeros(1,n), ones(1,m)];
[xb2 fvalb2]=linprog(f,Aeq,Beq,[],[])
</pre><pre class="codeoutput">Optimization terminated.

xb2 =

    0.0679
    0.0093
   -0.0398
    0.0426
   -0.0512
    0.0140
   -0.0346
    0.0283
   -0.0222
   -0.0352
   -0.0387
    0.0143
   -0.0020
   -0.0078
    0.0247
    0.0297
   -0.0023
    0.0249
    0.0492
    0.0161
   -0.0150
   -0.0111
    0.0500
    0.0355
   -0.0293
   -0.0129
    0.0203
   -0.0002
    0.0282
   -0.0673
    0.0095
    0.0102
    0.0226
   -0.0179
   -0.0230
    3.1505
   -0.0000
   -0.0000
    1.3869
    1.4394
   -0.0000
    4.5892
    0.0000
    4.5332
    2.1713
    3.3289
    5.2519
    3.6643
    0.0000
    1.0420
    8.1077
    0.4988
    3.6711
    0.0000
   -0.0000
    2.0641
    3.4126
    0.0000
    0.0000
    0.0000
    3.1246
    7.0044
    0.0000
    2.9022
    1.8077
    2.0643
    0.0000
    7.3391
    3.8452
    0.0000
    4.0237
    0.0000
    6.6505
    1.2509
    0.2999
    0.0000
    0.8846
    1.8754
    1.2476
    0.1358
   -0.0000
    6.9856
   -0.0000
   -0.0000
    1.5165
   -0.0000
    2.2311
    0.0000
    3.4434
    2.4316
   -0.0000
    2.8696
    6.8397
    0.7590
    5.1175
    8.7637
    4.7914
   -0.0000
   -0.0000
   -0.0000
    5.6125
    2.8948
    3.6281
    5.2157
   -0.0000
    2.4503
    1.1217
   -0.0000
    0.1325
    0.2239
    0.6057
    0.0000
    3.8617
    1.1463
    0.0000
    1.0294
   -0.0000
    5.7789
    1.4534
    1.5399
    2.1361
   -0.0000
    0.6528
   -0.0000
    3.0311
    6.0174
    4.4399
    3.0263
    4.0047
    0.0000
    0.0000
    5.9982
    3.6188
    0.0000
   -0.0000


fvalb2 =

  208.1371

</pre><h2>Problem 2c - l2 norm<a name="4"></a></h2><pre class="codeinput">aa = a'; bb = c';
x_l2 = aa'*((aa*aa')\ bb);
fval = norm((aa*x_l2)-bb)
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may
be inaccurate. RCOND =  3.379840e-20. 

fval =

  852.3910

</pre><h2>Problem 2d - sum norms<a name="5"></a></h2><pre class="codeinput">aa = a'; bb = c';
Aeq = [aa -eye(m) zeros(m,1);<span class="keyword">...</span>
       -aa -eye(m) zeros(m,1);<span class="keyword">...</span>
       zeros(m,n) eye(m) -ones(m,1)];
beq = [bb; -bb; zeros(m,1)];
f = [zeros(1,n), ones(1,m) 1];
[xsum, fsum] = linprog(f,Aeq,beq,[],[])
</pre><pre class="codeoutput">Optimization terminated.

xsum =

    0.0705
    0.0185
   -0.0259
    0.0326
   -0.0517
    0.0111
   -0.0356
    0.0196
   -0.0266
   -0.0232
   -0.0390
    0.0247
   -0.0134
   -0.0046
    0.0099
    0.0251
    0.0014
    0.0241
    0.0504
    0.0138
   -0.0214
   -0.0148
    0.0514
    0.0294
   -0.0299
   -0.0087
    0.0087
    0.0086
    0.0089
   -0.0763
    0.0057
    0.0135
    0.0280
   -0.0199
   -0.0119
    2.8948
    0.0000
    0.0000
    0.1644
    1.7913
   -0.0000
    4.1794
   -0.0000
    4.9156
    1.8765
    3.2289
    4.6213
    4.4968
   -0.0000
    0.9075
    6.9507
    0.3353
    3.6452
    0.0000
   -0.0000
    1.5503
    3.4045
    0.0000
   -0.0000
    0.2386
    4.0229
    6.9507
    0.0000
    4.4172
    1.3994
    2.5416
    0.2488
    6.7377
    3.3304
    0.0000
    5.0380
    0.0000
    6.7943
    2.1727
    0.0000
   -0.0000
    0.3256
    1.4090
    0.8373
    0.4319
    0.0000
    6.9507
    0.2492
    0.0000
    0.9488
    0.0000
    3.3404
    0.4572
    3.1368
    2.0120
    0.0000
    2.1122
    6.9507
    0.0000
    5.6089
    6.9507
    3.7544
    0.0000
    0.0000
    0.6089
    4.3825
    2.9448
    4.1013
    5.4211
    0.9994
    2.4777
    0.9247
    0.0431
    0.2344
   -0.0000
    1.9048
    0.0000
    3.5755
    1.3200
   -0.0000
   -0.0000
    0.0000
    6.2320
    0.9494
    2.4003
    2.4209
    0.0000
    0.0000
    0.0000
    3.3291
    5.8478
    4.8582
    3.5370
    4.3541
    1.0104
    0.0969
    5.7520
    4.4683
   -0.0000
    0.0000
    6.9507


fsum =

  215.4755

</pre><h2>Problem 3 maxflow<a name="6"></a></h2><pre class="codeinput">Aeq = [1 0 -1 -1 0 0 0 0; 0 1 0 0 -1 -1 0 0; <span class="keyword">...</span>
    0 0 1 0 1 0 -1 0; 0 0 0 1 0 1 0 -1];
Beq = zeros(1,4);
A = eye(8);
B = [13;12; 5; 1; 7; 1; 6; 4];
f = [-1 -1 0 0 0 0 0 0];
[xmax, fvalmax] = linprog(f,A,B,Aeq,Beq,zeros(1,8),7*ones(1,8))
</pre><pre class="codeoutput">Optimization terminated.

xmax =

    3.6134
    4.3866
    2.6134
    1.0000
    3.3866
    1.0000
    6.0000
    2.0000


fvalmax =

   -8.0000

</pre><h2>Problem 4 duality<a name="7"></a></h2><pre class="codeinput">Aeq = [1 0 -1 -1 0 0 0 0; 0 1 0 0 -1 -1 0 0; <span class="keyword">...</span>
    0 0 1 0 1 0 -1 0; 0 0 0 1 0 1 0 -1];
Beq = zeros(1,4);
c = f';
</pre><h2>Problem 5  three sets<a name="8"></a></h2><pre class="codeinput"><span class="comment">%constraint equality</span>
a = [1 1 1 0 0 0 0 0 0];
b = [0 0 0 1 1 1 0 0 0];
c = [0 0 0 0 0 0 1 1 1];

gfun = @myfun;

f= @(x) norm(a-b,2).^2+norm(c-b,2).^2+norm(a-c,2)^2;
x0 = [-2 1 0 1 2 1 0 0 0];
[x,fval,exitflag,output] = fmincon(f,x0,[],[],[],[],[],[],gfun)
</pre><pre class="codeoutput">
Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.




x =

  Columns 1 through 7

    8.3333   11.3333   10.3333    0.8084    0.7673    0.8084  -40.3083

  Columns 8 through 9

   29.1543  -19.4452


fval =

   18.0000


exitflag =

     1


output = 

         iterations: 18
          funcCount: 194
    constrviolation: 4.4260e-11
           stepsize: 6.0497e-06
          algorithm: 'interior-point'
      firstorderopt: 2.7802e-09
       cgiterations: 0
            message: 'Local minimum found that satisfies the constraints....'

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Jenny Qiu Optimization Assignment 2
%% Problem 1
load ('a2p1','-mat')
n = 35; m =100; 
ub = 0.00001*ones(100,1);
ub(23)=9999;
[x fval] = linprog(c,[],[],a,b,zeros(100,1),ub);
display(x(23))
display(fval)


[x2 fval2] = linprog(c,[],[],a,b,zeros(100,1),ub);
display(x2)
display(fval2)
ub2=ub;
ub2(4)=ub2(23);
ub2(12)=ub2(23);
[x3 fval3] = linprog(c,[],[],a,b,zeros(100,1),ub2);
display(x3)
display(fval3)
%% Problem 2a - infinity norm
n = 35; m =100; 
aa = a'; bb = c';
Aeq = [aa -ones(m,1);-aa -ones(m,1)];
Beq = [bb;-bb];
A = [aa zeros(m,1)];
B = [b; zeros(m-n,1)];
f = [zeros(1,n), 1];
[xb fvalb]=linprog(f,Aeq,Beq,[],[]);

%% Problem 2b - l1  norm
aa = a'; bb = c';
Aeq = [aa -eye(m, m);-aa -eye(m,m)];
Beq = [bb;-bb];
A = [aa zeros(m)];
B = [b; zeros(m-n,1)];
f = [zeros(1,n), ones(1,m)];
[xb2 fvalb2]=linprog(f,Aeq,Beq,[],[])

%% Problem 2c - l2 norm
aa = a'; bb = c';
x_l2 = aa'*((aa*aa')\ bb);
fval = norm((aa*x_l2)-bb)

%% Problem 2d - sum norms
aa = a'; bb = c';
Aeq = [aa -eye(m) zeros(m,1);...
       -aa -eye(m) zeros(m,1);...
       zeros(m,n) eye(m) -ones(m,1)];
beq = [bb; -bb; zeros(m,1)];
f = [zeros(1,n), ones(1,m) 1];
[xsum, fsum] = linprog(f,Aeq,beq,[],[])

%% Problem 3 maxflow
Aeq = [1 0 -1 -1 0 0 0 0; 0 1 0 0 -1 -1 0 0; ...
    0 0 1 0 1 0 -1 0; 0 0 0 1 0 1 0 -1];
Beq = zeros(1,4);
A = eye(8);
B = [13;12; 5; 1; 7; 1; 6; 4];
f = [-1 -1 0 0 0 0 0 0];
[xmax, fvalmax] = linprog(f,A,B,Aeq,Beq,zeros(1,8),7*ones(1,8))
%% Problem 4 duality
Aeq = [1 0 -1 -1 0 0 0 0; 0 1 0 0 -1 -1 0 0; ...
    0 0 1 0 1 0 -1 0; 0 0 0 1 0 1 0 -1];
Beq = zeros(1,4);
c = f';


%% Problem 5  three sets
%constraint equality
a = [1 1 1 0 0 0 0 0 0];
b = [0 0 0 1 1 1 0 0 0];
c = [0 0 0 0 0 0 1 1 1];

gfun = @myfun;

f= @(x) norm(a-b,2).^2+norm(c-b,2).^2+norm(a-c,2)^2;
x0 = [-2 1 0 1 2 1 0 0 0];
[x,fval,exitflag,output] = fmincon(f,x0,[],[],[],[],[],[],gfun)

##### SOURCE END #####
--></body></html>